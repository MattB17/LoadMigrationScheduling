<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MigrationScheduling.analysis &mdash; Load Migration Scheduling  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Load Migration Scheduling
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../Data/data.html">Migration Scheduling Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Sim/simulation.html">Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Model/model.html">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plotting.html">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../algorithms.html">Scheduling Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utils.html">Utility Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../exceptions.html">Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../validation.html">Validation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Load Migration Scheduling</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
      <li>MigrationScheduling.analysis</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for MigrationScheduling.analysis</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;This module contains a collection of functions to help with high level</span>
<span class="sd">analysis of results.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="k">as</span> <span class="nn">mp</span>
<span class="kn">from</span> <span class="nn">timeit</span> <span class="kn">import</span> <span class="n">default_timer</span> <span class="k">as</span> <span class="n">timer</span>
<span class="kn">from</span> <span class="nn">MigrationScheduling.Model</span> <span class="kn">import</span> <span class="n">Optimizer</span>
<span class="kn">from</span> <span class="nn">MigrationScheduling</span> <span class="kn">import</span> <span class="n">algorithms</span><span class="p">,</span> <span class="n">specs</span><span class="p">,</span> <span class="n">utils</span>


<div class="viewcode-block" id="get_cores_and_instances_per_core"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.get_cores_and_instances_per_core">[docs]</a><span class="k">def</span> <span class="nf">get_cores_and_instances_per_core</span><span class="p">(</span><span class="n">instance_count</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gets the number of cores to use and the number of instances per core.</span>

<span class="sd">    The number of cores to use is based on the system and `instance_count`.</span>
<span class="sd">    Then, based on the number of cores, the number of instances per core is</span>
<span class="sd">    calculated using `instance_count`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    instance_count: int</span>
<span class="sd">        A count of the number of instances to be analyzed.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    int, int</span>
<span class="sd">        Two integers. The first represents the number of cores to be used and</span>
<span class="sd">        the second represents the number of instances that will be analyzed</span>
<span class="sd">        on each core.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">core_count</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">instance_count</span><span class="p">,</span> <span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">instances_per_core</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">instance_count</span> <span class="o">/</span> <span class="n">core_count</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">core_count</span><span class="p">,</span> <span class="n">instances_per_core</span></div>


<div class="viewcode-block" id="get_instances_for_core"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.get_instances_for_core">[docs]</a><span class="k">def</span> <span class="nf">get_instances_for_core</span><span class="p">(</span><span class="n">instance_files</span><span class="p">,</span> <span class="n">instances_per_core</span><span class="p">,</span> <span class="n">core_num</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gets the instances from `instance_files` to be analyzed on `core_num`.</span>

<span class="sd">    A subset of `instance_files` is taken so that `core_num` processes roughly</span>
<span class="sd">    `instances_per_core` instances.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    instance_files: list</span>
<span class="sd">        A list of strings representing the filenames of the instances to be</span>
<span class="sd">        analyzed.</span>
<span class="sd">    instances_per_core: int</span>
<span class="sd">        An integer representing the number of instances to be processed on</span>
<span class="sd">        each machine core.</span>
<span class="sd">    core_num: int</span>
<span class="sd">        An integer representing the core number for which the instances are</span>
<span class="sd">        retrieved.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list</span>
<span class="sd">        A subset of `instance_files` representing the instances to be</span>
<span class="sd">        processed on `core_num`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">instances_per_core</span> <span class="o">*</span> <span class="n">core_num</span>
    <span class="n">end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">instance_files</span><span class="p">),</span> <span class="n">instances_per_core</span> <span class="o">*</span> <span class="p">(</span><span class="n">core_num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">instance_files</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span></div>


<div class="viewcode-block" id="initialize_and_join_processes"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.initialize_and_join_processes">[docs]</a><span class="k">def</span> <span class="nf">initialize_and_join_processes</span><span class="p">(</span><span class="n">procs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initializes and joins all the processes in `procs`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    procs</span>
<span class="sd">        A list of `mp.Process` objects representing the processes to be</span>
<span class="sd">        initialized and joined.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">proc</span> <span class="ow">in</span> <span class="n">procs</span><span class="p">:</span>
        <span class="n">proc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">proc</span> <span class="ow">in</span> <span class="n">procs</span><span class="p">:</span>
        <span class="n">proc</span><span class="o">.</span><span class="n">join</span><span class="p">()</span></div>


<div class="viewcode-block" id="build_heuristics_string"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.build_heuristics_string">[docs]</a><span class="k">def</span> <span class="nf">build_heuristics_string</span><span class="p">(</span><span class="n">instance_data</span><span class="p">,</span> <span class="n">resiliency</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Builds the heuristics string for `instance_data`.</span>

<span class="sd">    The heuristics string is a space separated string containing the results</span>
<span class="sd">    of running the heuristic algorithms on `instance_data`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    instance_data: InstanceData</span>
<span class="sd">        An `InstanceData` object specifying an instance of the load migration</span>
<span class="sd">        scheduling problem.</span>
<span class="sd">    resiliency: bool</span>
<span class="sd">        A boolean indicating whether failure resilience is considered when</span>
<span class="sd">        calculating solutions. The default value is False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        The heuristics string for `instance_data`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">timer</span><span class="p">()</span>
    <span class="n">vff</span> <span class="o">=</span> <span class="n">algorithms</span><span class="o">.</span><span class="n">vector_first_fit</span><span class="p">(</span><span class="n">instance_data</span><span class="p">,</span> <span class="n">resiliency</span><span class="p">)</span>
    <span class="n">vff_time</span> <span class="o">=</span> <span class="n">timer</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

    <span class="n">start</span> <span class="o">=</span> <span class="n">timer</span><span class="p">()</span>
    <span class="n">cbf</span> <span class="o">=</span> <span class="n">algorithms</span><span class="o">.</span><span class="n">current_bottleneck_first</span><span class="p">(</span>
        <span class="n">instance_data</span><span class="p">,</span> <span class="n">specs</span><span class="o">.</span><span class="n">CBF_CHOICES</span><span class="p">,</span> <span class="n">resiliency</span><span class="p">)</span>
    <span class="n">cbf_time</span> <span class="o">=</span> <span class="n">timer</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> </span><span class="si">{1}</span><span class="s2"> </span><span class="si">{2}</span><span class="s2"> </span><span class="si">{3}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vff</span><span class="p">,</span> <span class="n">vff_time</span><span class="p">,</span> <span class="n">cbf</span><span class="p">,</span> <span class="n">cbf_time</span><span class="p">)</span></div>


<div class="viewcode-block" id="build_optimal_string"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.build_optimal_string">[docs]</a><span class="k">def</span> <span class="nf">build_optimal_string</span><span class="p">(</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">resiliency</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Builds the optimal string from the optimizer.</span>

<span class="sd">    The optimal string is a space-separated string reporting the optimal</span>
<span class="sd">    result and time taken by the optimizer to find the optimal solution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    optimizer: Optimizer</span>
<span class="sd">        An `Optimizer` object used to find the optimal solution for an</span>
<span class="sd">        instance of the load migration scheduling problem.</span>
<span class="sd">    resiliency: bool</span>
<span class="sd">        A boolean indicating whether failure resilience is considered when</span>
<span class="sd">        calculating solutions. The default value is False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        The optimal string obtained from the optimizer.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">timer</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">optimizer</span><span class="o">.</span><span class="n">build_ip_model</span><span class="p">(</span>
            <span class="n">resiliency</span><span class="o">=</span><span class="n">resilience</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">opt_time</span> <span class="o">=</span> <span class="n">timer</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">opt_time</span><span class="p">)</span></div>


<div class="viewcode-block" id="build_results_string"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.build_results_string">[docs]</a><span class="k">def</span> <span class="nf">build_results_string</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">instance_file</span><span class="p">,</span> <span class="n">output_idx</span><span class="p">,</span>
                         <span class="n">run_optimizer</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resiliency</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Builds the results string for the instance given in `instance_file`.</span>

<span class="sd">    The results string is a space separated string specifying the size of the</span>
<span class="sd">    instance being solved followed by the results and time used to compute</span>
<span class="sd">    each result.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    input_dir: str</span>
<span class="sd">        A string specifying the name of the directory from which the</span>
<span class="sd">        instance will be read.</span>
<span class="sd">    instance_file: str</span>
<span class="sd">        A string specifying the name of a file containing the instance to</span>
<span class="sd">        be solved.</span>
<span class="sd">    output_idx: int</span>
<span class="sd">        An integer identifying the index of the instance being output.</span>
<span class="sd">    run_optimizer: bool</span>
<span class="sd">        A boolean specifying whether the optimizer will be run to find the</span>
<span class="sd">        optimal solution of the instance. Otherwise, just the heuristic</span>
<span class="sd">        algorithms are run. The default value is False.</span>
<span class="sd">    resiliency: bool</span>
<span class="sd">        A boolean indicating whether failure resilience is considered when</span>
<span class="sd">        calculating solutions. The default value is False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        A string representing the results for `instance_file`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">Optimizer</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">get_model_data</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">instance_file</span><span class="p">))</span>
    <span class="n">results_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> </span><span class="si">{1}</span><span class="s2"> </span><span class="si">{2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">output_idx</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">get_size_string</span><span class="p">(),</span>
        <span class="n">build_heuristics_string</span><span class="p">(</span><span class="n">optimizer</span><span class="o">.</span><span class="n">instance_data</span><span class="p">(),</span> <span class="n">resiliency</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">run_optimizer</span><span class="p">:</span>
        <span class="n">results_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">results_str</span><span class="p">,</span> <span class="n">build_optimal_string</span><span class="p">(</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">resiliency</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">results_str</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="get_results_for_instances"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.get_results_for_instances">[docs]</a><span class="k">def</span> <span class="nf">get_results_for_instances</span><span class="p">(</span><span class="n">results_list</span><span class="p">,</span> <span class="n">instance_files</span><span class="p">,</span>
                              <span class="n">file_pattern</span><span class="p">,</span> <span class="n">input_dir</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gets results for all the instances specified in `instance_files`.</span>

<span class="sd">    For each instance in `instance_files` the result string is computed and</span>
<span class="sd">    appended to `results_list`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    results_list: mp.Manager().list</span>
<span class="sd">        A multiprocessing list to which the result strings are appended.</span>
<span class="sd">    instance_files: list</span>
<span class="sd">        A list of strings representing the names of files specifying the</span>
<span class="sd">        instances to be analyzed.</span>
<span class="sd">    file_pattern: str</span>
<span class="sd">        A string representing the pattern used for the instance files.</span>
<span class="sd">    input_dir: str</span>
<span class="sd">        A string specifying the directory from which the instances are read.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">instance_file</span> <span class="ow">in</span> <span class="n">instance_files</span><span class="p">:</span>
        <span class="n">output_idx</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_file_idx</span><span class="p">(</span><span class="n">instance_file</span><span class="p">,</span> <span class="n">file_pattern</span><span class="p">)</span>
        <span class="n">results_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">build_results_string</span><span class="p">(</span>
            <span class="n">input_dir</span><span class="p">,</span> <span class="n">instance_file</span><span class="p">,</span> <span class="n">output_idx</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span></div>

<div class="viewcode-block" id="write_optimal_results"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.write_optimal_results">[docs]</a><span class="k">def</span> <span class="nf">write_optimal_results</span><span class="p">(</span><span class="n">instance_file</span><span class="p">,</span> <span class="n">input_dir</span><span class="p">,</span> <span class="n">result_idx</span><span class="p">,</span>
                          <span class="n">output_dir</span><span class="p">,</span> <span class="n">resiliency</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Writes the results of solving `instance_file` optimally.</span>

<span class="sd">    The instance specified in `instance_file` is solved optimally and with</span>
<span class="sd">    the heuristic algorithms and the results are written to `output_dir`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    instance_file: str</span>
<span class="sd">        A string specifying the name of a file containing the instance to</span>
<span class="sd">        be solved.</span>
<span class="sd">    input_dir: str</span>
<span class="sd">        A string specifying the name of the directory from which the instance</span>
<span class="sd">        file is read.</span>
<span class="sd">    result_idx: int</span>
<span class="sd">        An integer identifying the result file to be created for the instance.</span>
<span class="sd">    output_dir: str</span>
<span class="sd">        A string identifying the directory to which the results will be</span>
<span class="sd">        written.</span>
<span class="sd">    resiliency: bool</span>
<span class="sd">        A boolean indicating whether failure resilience is considered when</span>
<span class="sd">        calculating solutions. The default value is False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;results</span><span class="si">{}</span><span class="s2">.txt&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result_idx</span><span class="p">))</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">results_file</span><span class="p">:</span>
        <span class="n">results_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">get_results_header</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
        <span class="n">results_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">build_results_string</span><span class="p">(</span>
            <span class="n">input_dir</span><span class="p">,</span> <span class="n">instance_file</span><span class="p">,</span> <span class="n">result_idx</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">resiliency</span><span class="p">))</span></div>

<div class="viewcode-block" id="solve_instances_optimally"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.solve_instances_optimally">[docs]</a><span class="k">def</span> <span class="nf">solve_instances_optimally</span><span class="p">(</span><span class="n">instance_files</span><span class="p">,</span> <span class="n">input_dir</span><span class="p">,</span> <span class="n">file_pattern</span><span class="p">,</span>
                              <span class="n">output_dir</span><span class="p">,</span> <span class="n">resiliency</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Finds the optimal solution for each instance in `instance_files`.</span>

<span class="sd">    Each file in `instance_files` is read from `input_dir` and the</span>
<span class="sd">    corresponding instance is solved optimally and with the heuristic</span>
<span class="sd">    algorithms. The results are then written to `output_dir`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    instance_files: list</span>
<span class="sd">        A list of strings specifying the names of the instance files to be</span>
<span class="sd">        solved optimally.</span>
<span class="sd">    input_dir: str</span>
<span class="sd">        A string representing the name of the directory from which the</span>
<span class="sd">        instances are read.</span>
<span class="sd">    file_pattern: str</span>
<span class="sd">        A string identifying the pattern of the instance files.</span>
<span class="sd">    output_dir: str</span>
<span class="sd">        A string representing the name of the directory to which the results</span>
<span class="sd">        will be written.</span>
<span class="sd">    resiliency: bool</span>
<span class="sd">        A boolean indicating whether failure resilience is considered when</span>
<span class="sd">        calculating solutions. The default value is False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">instance_file</span> <span class="ow">in</span> <span class="n">instance_files</span><span class="p">:</span>
        <span class="n">curr_idx</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_file_idx</span><span class="p">(</span><span class="n">instance_file</span><span class="p">,</span> <span class="n">file_pattern</span><span class="p">)</span>
        <span class="n">write_optimal_results</span><span class="p">(</span>
            <span class="n">instance_file</span><span class="p">,</span> <span class="n">input_dir</span><span class="p">,</span> <span class="n">curr_idx</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">,</span> <span class="n">resiliency</span><span class="p">)</span></div>


<div class="viewcode-block" id="write_results_to_file"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.write_results_to_file">[docs]</a><span class="k">def</span> <span class="nf">write_results_to_file</span><span class="p">(</span><span class="n">results_list</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">with_opt</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Write the results in `results_list` to `output_file`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    results_list: list</span>
<span class="sd">        A list of strings representing the result strings for the instances</span>
<span class="sd">        that have been analyzed.</span>
<span class="sd">    output_file: str</span>
<span class="sd">        A string representing the name of the file to which the results will</span>
<span class="sd">        be written.</span>
<span class="sd">    with_opt: bool</span>
<span class="sd">        A boolean value indicating whether the results include the solution</span>
<span class="sd">        value of the optimal solution. The default value is False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">results_file</span><span class="p">:</span>
        <span class="n">results_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">get_results_header</span><span class="p">(</span><span class="n">with_opt</span><span class="p">))</span>
        <span class="n">results_file</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">results_list</span><span class="p">)</span></div>


<div class="viewcode-block" id="calculate_heuristic_results_for_instances"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.calculate_heuristic_results_for_instances">[docs]</a><span class="k">def</span> <span class="nf">calculate_heuristic_results_for_instances</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">file_pattern</span><span class="p">,</span>
                                              <span class="n">instance_files</span><span class="p">,</span> <span class="n">output_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gets the heuristic results for each instance in `instance_files`.</span>

<span class="sd">    For each instance in `instance_files`, the instance is solved with the</span>
<span class="sd">    vector first fit and current bottleneck first algorithms. A string</span>
<span class="sd">    is generated of the results and the results of all instances are</span>
<span class="sd">    written to `output_file` with 1 result per line.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    input_dir: str</span>
<span class="sd">        A string representing the name of the directory from which the</span>
<span class="sd">        instance files are read.</span>
<span class="sd">    file_pattern: str</span>
<span class="sd">        A string identifying the pattern of the instance files.</span>
<span class="sd">    instance_files: list</span>
<span class="sd">        A list of strings representing the names of the files specifying the</span>
<span class="sd">        instances for which the results are calculated.</span>
<span class="sd">    output_file: str</span>
<span class="sd">        A string representing the name of the file to which the results will</span>
<span class="sd">        be written.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
    <span class="n">procs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cores</span><span class="p">,</span> <span class="n">instances_per_core</span> <span class="o">=</span> <span class="n">get_cores_and_instances_per_core</span><span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">instance_files</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">core_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cores</span><span class="p">):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">get_instances_for_core</span><span class="p">(</span>
            <span class="n">instance_files</span><span class="p">,</span> <span class="n">instances_per_core</span><span class="p">,</span> <span class="n">core_num</span><span class="p">)</span>
        <span class="n">procs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">get_results_for_instances</span><span class="p">,</span>
                                <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">instances</span><span class="p">,</span>
                                      <span class="n">file_pattern</span><span class="p">,</span> <span class="n">input_dir</span><span class="p">)))</span>
    <span class="n">initialize_and_join_processes</span><span class="p">(</span><span class="n">procs</span><span class="p">)</span>
    <span class="n">write_results_to_file</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">results</span><span class="p">),</span> <span class="n">output_file</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="calculate_optimal_results_for_instances"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.calculate_optimal_results_for_instances">[docs]</a><span class="k">def</span> <span class="nf">calculate_optimal_results_for_instances</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">file_pattern</span><span class="p">,</span>
                                            <span class="n">instance_files</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">,</span>
                                            <span class="n">resiliency</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gets the optimal results for each instance in `instance_files`.</span>

<span class="sd">    For each instance in `instance_files`, the instance is solved optimally</span>
<span class="sd">    and with the vector first fit and current bottleneck first algorithms. A</span>
<span class="sd">    string is generated of the results and the results of all instances are</span>
<span class="sd">    written to `output_file` with 1 result per line.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    input_dir: str</span>
<span class="sd">        A string representing the name of the directory from which the</span>
<span class="sd">        instance files are read.</span>
<span class="sd">    file_pattern: str</span>
<span class="sd">        A string identifying the pattern of the instance files.</span>
<span class="sd">    instance_files: list</span>
<span class="sd">        A list of strings representing the names of the files specifying the</span>
<span class="sd">        instances for which the results are calculated.</span>
<span class="sd">    output_file: str</span>
<span class="sd">        A string representing the name of the file to which the results will</span>
<span class="sd">        be written.</span>
<span class="sd">    resiliency: bool</span>
<span class="sd">        A boolean indicating whether failure resilience is considered when</span>
<span class="sd">        calculating solutions. The default value is False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">procs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cores</span><span class="p">,</span> <span class="n">instances_per_core</span> <span class="o">=</span> <span class="n">get_cores_and_instances_per_core</span><span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">instance_files</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">core_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cores</span><span class="p">):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">get_instances_for_core</span><span class="p">(</span>
            <span class="n">instance_files</span><span class="p">,</span> <span class="n">instances_per_core</span><span class="p">,</span> <span class="n">core_num</span><span class="p">)</span>
        <span class="n">procs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">solve_instances_optimally</span><span class="p">,</span>
                                <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">input_dir</span><span class="p">,</span> <span class="n">file_pattern</span><span class="p">,</span>
                                      <span class="n">output_dir</span><span class="p">,</span> <span class="n">resiliency</span><span class="p">)))</span>
    <span class="n">initialize_and_join_processes</span><span class="p">(</span><span class="n">procs</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_sim_tuples_for_core"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.get_sim_tuples_for_core">[docs]</a><span class="k">def</span> <span class="nf">get_sim_tuples_for_core</span><span class="p">(</span><span class="n">instance_sizes</span><span class="p">,</span> <span class="n">sims_per_core</span><span class="p">,</span>
                            <span class="n">core_num</span><span class="p">,</span> <span class="n">start_idx</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gets the simulation tuples to be simulated on `core_num`.</span>

<span class="sd">    The simulation tuples identify the instance number and instance size</span>
<span class="sd">    taken from `instance_sizes` to be simulated on `core_num`. Roughly</span>
<span class="sd">    `sims_per_core` instances will be simulated on the core.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    instance_sizes: list</span>
<span class="sd">        A list of integers representing the number of migrations in each</span>
<span class="sd">        simulated instance.</span>
<span class="sd">    sims_per_core: int</span>
<span class="sd">        An integer representing the number of simulations to be completed</span>
<span class="sd">        on each machine core.</span>
<span class="sd">    core_num: int</span>
<span class="sd">        An integer representing the index of the core for which the</span>
<span class="sd">        simulation tuples are retrieved.</span>
<span class="sd">    start_idx: int</span>
<span class="sd">        An integer denoting the index at which to start counting for</span>
<span class="sd">        the instance numbers.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list</span>
<span class="sd">        A list of two element tuples representing the simulation tuples for</span>
<span class="sd">        `core_num`. The first element of each tuple is an integer identifying</span>
<span class="sd">        the instance number and the second is an integer representing the</span>
<span class="sd">        number of migrations in the instance.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">sims_per_core</span> <span class="o">*</span> <span class="n">core_num</span>
    <span class="n">end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">instance_sizes</span><span class="p">),</span> <span class="n">sims_per_core</span> <span class="o">*</span> <span class="p">(</span><span class="n">core_num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">[(</span><span class="n">start_idx</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">instance_sizes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)]</span></div>


<div class="viewcode-block" id="simulate_instance"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.simulate_instance">[docs]</a><span class="k">def</span> <span class="nf">simulate_instance</span><span class="p">(</span><span class="n">sim_cls</span><span class="p">,</span> <span class="n">sim_args</span><span class="p">,</span> <span class="n">instance_idx</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simulates `instance_idx` having `size` migrations with `sim_cls`.</span>

<span class="sd">    An instance is simulated using `sim_cls` with `sim_args` as arguments</span>
<span class="sd">    and the result is written to `output_dir`. The instance number is</span>
<span class="sd">    `instance_idx` and it has `size` migrations.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sim_cls: Simulator.class</span>
<span class="sd">        A `Simulator` class object specifying the type of simulation being</span>
<span class="sd">        performed.</span>
<span class="sd">    sim_args: dict</span>
<span class="sd">        A dictionary specifying arguments for `sim_cls`. The keys are</span>
<span class="sd">        strings specifying the argument names and the corresponding value</span>
<span class="sd">        is the argument value to be passed to `sim_cls`</span>
<span class="sd">    instance_idx: int</span>
<span class="sd">        An integer representing the index of the instance being simulated.</span>
<span class="sd">    size: int</span>
<span class="sd">        An integer representing the number of migrations in the simulated</span>
<span class="sd">        instance.</span>
<span class="sd">    output_dir: str</span>
<span class="sd">        A string identifying the directory to which the instance file will be</span>
<span class="sd">        written.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;migrations</span><span class="si">{}</span><span class="s2">.txt&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">instance_idx</span><span class="p">))</span>
    <span class="n">simulator</span> <span class="o">=</span> <span class="n">sim_cls</span><span class="p">(</span><span class="o">**</span><span class="n">sim_args</span><span class="p">)</span>
    <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">output_file</span><span class="p">)</span></div>


<div class="viewcode-block" id="simulate_all_instances"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.simulate_all_instances">[docs]</a><span class="k">def</span> <span class="nf">simulate_all_instances</span><span class="p">(</span><span class="n">sim_cls</span><span class="p">,</span> <span class="n">sim_args</span><span class="p">,</span> <span class="n">sim_tuples</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An instance is simulated for each instance specified in `sim_tuples`.</span>

<span class="sd">    The simulation is done using `sim_cls` with arguments `sim_args`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sim_cls: Simulator.class</span>
<span class="sd">        A `Simulator` class object specifying the type of simulation being</span>
<span class="sd">        performed.</span>
<span class="sd">    sim_args: dict</span>
<span class="sd">        A dictionary specifying arguments for `sim_cls`. The keys are</span>
<span class="sd">        strings specifying the argument names and the corresponding value</span>
<span class="sd">        is the argument value to be passed to `sim_cls`</span>
<span class="sd">    sim_tuples: list</span>
<span class="sd">        A list of two element tuples specifying the parameters of each</span>
<span class="sd">        instance to be simulated. Both elements of each tuples are integers</span>
<span class="sd">        specifying the index of the instance and the number of migrations.</span>
<span class="sd">    output_dir: str</span>
<span class="sd">        A string specifying the directory to which the instance will be output.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">sim_tuple</span> <span class="ow">in</span> <span class="n">sim_tuples</span><span class="p">:</span>
        <span class="n">simulate_instance</span><span class="p">(</span>
            <span class="n">sim_cls</span><span class="p">,</span> <span class="n">sim_args</span><span class="p">,</span> <span class="n">sim_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sim_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">output_dir</span><span class="p">)</span></div>


<div class="viewcode-block" id="create_simulated_instances"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.create_simulated_instances">[docs]</a><span class="k">def</span> <span class="nf">create_simulated_instances</span><span class="p">(</span><span class="n">sim_cls</span><span class="p">,</span> <span class="n">sim_args</span><span class="p">,</span>
                               <span class="n">instance_sizes</span><span class="p">,</span> <span class="n">start_idx</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simulates instances of the sizes specified in `instance_sizes`.</span>

<span class="sd">    An instance is simulated for each element of `instance_sizes` where</span>
<span class="sd">    the number of migrations of the instance is equal to the corresponding</span>
<span class="sd">    element of `instance_sizes`. The instances are numbered contiguously</span>
<span class="sd">    starting from `start_idx` and written to `output_dir`. The simulation</span>
<span class="sd">    is performed by `sim_cls`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sim_cls: Simulator.class</span>
<span class="sd">        A `Simulator` class object specifying the type of simulation being</span>
<span class="sd">        performed.</span>
<span class="sd">    sim_args: dict</span>
<span class="sd">        A dictionary specifying arguments for `sim_cls`. The keys are</span>
<span class="sd">        strings specifying the argument names and the corresponding value</span>
<span class="sd">        is the argument value to be passed to `sim_cls`</span>
<span class="sd">    instance_sizes: list</span>
<span class="sd">        A list of integers representing the number of migrations in each</span>
<span class="sd">        simulated instance.</span>
<span class="sd">    start_idx: int</span>
<span class="sd">        An integer denoting the instance number from which instances are</span>
<span class="sd">        numbered.</span>
<span class="sd">    output_dir: str</span>
<span class="sd">        A string specifying the directory to which the instance files will</span>
<span class="sd">        be written.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">procs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cores</span><span class="p">,</span> <span class="n">sims_per_core</span> <span class="o">=</span> <span class="n">get_cores_and_instances_per_core</span><span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">instance_sizes</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">core_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cores</span><span class="p">):</span>
        <span class="n">sim_tuples</span> <span class="o">=</span> <span class="n">get_sim_tuples_for_core</span><span class="p">(</span>
            <span class="n">instance_sizes</span><span class="p">,</span> <span class="n">sims_per_core</span><span class="p">,</span> <span class="n">core_num</span><span class="p">,</span> <span class="n">start_idx</span><span class="p">)</span>
        <span class="n">procs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span>
            <span class="n">target</span><span class="o">=</span><span class="n">simulate_all_instances</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">sim_cls</span><span class="p">,</span> <span class="n">sim_args</span><span class="p">,</span> <span class="n">sim_tuples</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">)))</span>
    <span class="n">initialize_and_join_processes</span><span class="p">(</span><span class="n">procs</span><span class="p">)</span></div>


<div class="viewcode-block" id="combine_optimal_results_files"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.combine_optimal_results_files">[docs]</a><span class="k">def</span> <span class="nf">combine_optimal_results_files</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">results_files</span><span class="p">,</span> <span class="n">output_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Combines the results in `results_files` and writes to `output_file`.</span>

<span class="sd">    The results are read from each file in `results_file` and combined into</span>
<span class="sd">    one file which is then written to `output_file`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    input_dir: str</span>
<span class="sd">        A string representing the directory from which the result files are</span>
<span class="sd">        read.</span>
<span class="sd">    results_files: list</span>
<span class="sd">        A list of strings representing the names of the result files to be</span>
<span class="sd">        combined.</span>
<span class="sd">    output_file: str</span>
<span class="sd">        A string representing the name of the file to which the combined</span>
<span class="sd">        results will be output.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">result_file</span> <span class="ow">in</span> <span class="n">results_files</span><span class="p">:</span>
        <span class="n">result_line</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_opt_results_from_file</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">result_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result_line</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result_line</span><span class="p">)</span>
    <span class="n">write_results_to_file</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="load_results_df"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.load_results_df">[docs]</a><span class="k">def</span> <span class="nf">load_results_df</span><span class="p">(</span><span class="n">results_file</span><span class="p">,</span> <span class="n">sort_col</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Loads a results dataframe from `results_file`.</span>

<span class="sd">    The results dataframe contains the results of solving load migration</span>
<span class="sd">    scheduling instances and is sorted according to `sort_col`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    results_file: str</span>
<span class="sd">        A string representing the location of the file containing the results.</span>
<span class="sd">    sort_col: str</span>
<span class="sd">        A string representing the name of the column by which the results</span>
<span class="sd">        will be sorted.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">        A DataFrame containing the results loaded from `results_file`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">results_file</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="n">results_df</span> <span class="o">=</span> <span class="n">results_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">sort_col</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">results_df</span></div>

<div class="viewcode-block" id="get_time_df"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.get_time_df">[docs]</a><span class="k">def</span> <span class="nf">get_time_df</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">group_col</span><span class="p">,</span> <span class="n">time_cols</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates a time dataframe from `results_df`.</span>

<span class="sd">    A dataframe is created from `results_df` when restricted to `time_cols`</span>
<span class="sd">    and grouping by `group_col`, where the values are averages per distinct</span>
<span class="sd">    value of `group_col`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    results_df: pd.DataFrame</span>
<span class="sd">        A pandas dataframe of experimental results which is used to create</span>
<span class="sd">        the time dataframe.</span>
<span class="sd">    group_col: str</span>
<span class="sd">        A string representing the column to group by when creating the time</span>
<span class="sd">        dataframe.</span>
<span class="sd">    time_cols: list</span>
<span class="sd">        A list of strings representing the names of the columns of the time</span>
<span class="sd">        variables from `results_df` to be included in the time dataframe.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">        A pandas DataFrame representing the time dataframe generated from</span>
<span class="sd">        `results_df`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">results_df</span><span class="p">[[</span><span class="n">group_col</span><span class="p">]</span> <span class="o">+</span> <span class="n">time_cols</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">group_col</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span></div>


<div class="viewcode-block" id="get_proportion_better"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.get_proportion_better">[docs]</a><span class="k">def</span> <span class="nf">get_proportion_better</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">heuristic1</span><span class="p">,</span> <span class="n">heuristic2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The proportion of times `heuristic1` outperforms `heuristic2`.</span>

<span class="sd">    The performance of the two heuristics is taken from `results_df`.</span>
<span class="sd">    `heuristic1` outperforms `heuristic2` if it requires fewer rounds on</span>
<span class="sd">    the same instance.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    results_df: pd.DataFrame</span>
<span class="sd">        A pandas DataFrame of experimental results for the heuristics.</span>
<span class="sd">    heuristic1: str</span>
<span class="sd">        A string representing the heuristic of interest.</span>
<span class="sd">    heuristic2: str</span>
<span class="sd">        A string representing the heuristic being compared against.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        A float representing the proportion of times `heuristic1`</span>
<span class="sd">        outperforms `heuristic2`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">outperform_indicator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">results_df</span><span class="p">[</span><span class="n">heuristic1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">results_df</span><span class="p">[</span><span class="n">heuristic2</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">outperform_indicator</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span></div>


<div class="viewcode-block" id="get_improvement_ratios"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.get_improvement_ratios">[docs]</a><span class="k">def</span> <span class="nf">get_improvement_ratios</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">method1</span><span class="p">,</span> <span class="n">method2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gets round improvement ratios of `method1` over `method2`.</span>

<span class="sd">    The round improvement ratios are calculated using `results_df` and</span>
<span class="sd">    represent the statistics for the times that `method1` completes in</span>
<span class="sd">    fewer rounds than `method2`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    results_df: pd.DataFrame</span>
<span class="sd">        A pandas DataFrame of experimental results for the methods.</span>
<span class="sd">    method1: str</span>
<span class="sd">        A string representing the method of interest.</span>
<span class="sd">    method2: str</span>
<span class="sd">        A string representing the method being compared against.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float, float</span>
<span class="sd">        A float denoting the minimum of `method1` over `method2` in</span>
<span class="sd">        `results_df` and a float representing the average of that ratio.</span>
<span class="sd">        Both ratios are restricted to the instances where `method1`</span>
<span class="sd">        represents an improvement over `method2`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">improvement_vals</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="n">method1</span><span class="p">]</span> <span class="o">/</span> <span class="n">results_df</span><span class="p">[</span><span class="n">method2</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">improvement_vals</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
            <span class="n">improvement_vals</span><span class="p">[</span><span class="n">improvement_vals</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span></div>

<div class="viewcode-block" id="get_deterioration_ratios"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.get_deterioration_ratios">[docs]</a><span class="k">def</span> <span class="nf">get_deterioration_ratios</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">method1</span><span class="p">,</span> <span class="n">method2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gets round deterioration ratios of `method1` over `method2`.</span>

<span class="sd">    The round deterioration ratios are calculated using `results_df` and</span>
<span class="sd">    represent the statistics for the times that `method1` completes in</span>
<span class="sd">    more rounds than `method2`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    results_df: pd.DataFrame</span>
<span class="sd">        A pandas DataFrame of experimental results for the methods.</span>
<span class="sd">    method1: str</span>
<span class="sd">        A string representing the method of interest.</span>
<span class="sd">    method2: str</span>
<span class="sd">        A string representing the method being compared against.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float, float</span>
<span class="sd">        A float denoting the maximum of `method1` over `method2` in</span>
<span class="sd">        `results_df` and a float representing the average of that ratio.</span>
<span class="sd">        Both ratios are restricted to the instances where `method1` requires</span>
<span class="sd">        more rounds that `method2`</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">improvement_vals</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="n">method1</span><span class="p">]</span> <span class="o">/</span> <span class="n">results_df</span><span class="p">[</span><span class="n">method2</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">improvement_vals</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
            <span class="n">improvement_vals</span><span class="p">[</span><span class="n">improvement_vals</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span></div>

<div class="viewcode-block" id="get_improvement_stats"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.get_improvement_stats">[docs]</a><span class="k">def</span> <span class="nf">get_improvement_stats</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">method1</span><span class="p">,</span> <span class="n">method2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gets the improvement statistics of `method1` over `method2`.</span>

<span class="sd">    The improvement statistics of `method1` over `method2` are based on</span>
<span class="sd">    `results_df` and represent statistics for the instances where `method1`</span>
<span class="sd">    is better than `method2`. These statistics are the percent of instances</span>
<span class="sd">    in which `method1` is better than `method2` as well as the minimum and</span>
<span class="sd">    mean ratio of the two methods in these instances.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    results_df: pd.DataFrame</span>
<span class="sd">        A pandas DataFrame of experimental results for the methods.</span>
<span class="sd">    method1: str</span>
<span class="sd">        A string representing the method of interest.</span>
<span class="sd">    method2: str</span>
<span class="sd">        A string representing the method being compared against.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        A dictionary recording the improvement statistics of `method1` over</span>
<span class="sd">        `method2`. The keys are strings representing the names of the various</span>
<span class="sd">        statistics and the corresponding value is the value of the statistic.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">improve_stats</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">percent_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f instances with </span><span class="si">{0}</span><span class="s2"> &lt; </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method1</span><span class="p">,</span> <span class="n">method2</span><span class="p">)</span>
    <span class="n">min_str</span> <span class="o">=</span> <span class="s2">&quot;min </span><span class="si">{0}</span><span class="s2"> / </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method1</span><span class="p">,</span> <span class="n">method2</span><span class="p">)</span>
    <span class="n">mean_str</span> <span class="o">=</span> <span class="s2">&quot;improvement mean </span><span class="si">{0}</span><span class="s2"> / </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method1</span><span class="p">,</span> <span class="n">method2</span><span class="p">)</span>
    <span class="n">improve_stats</span><span class="p">[</span><span class="n">percent_str</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_proportion_better</span><span class="p">(</span>
        <span class="n">results_df</span><span class="p">,</span> <span class="n">method1</span><span class="p">,</span> <span class="n">method2</span><span class="p">)</span>
    <span class="n">min_val</span><span class="p">,</span> <span class="n">mean_val</span> <span class="o">=</span> <span class="n">get_improvement_ratios</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">method1</span><span class="p">,</span> <span class="n">method2</span><span class="p">)</span>
    <span class="n">improve_stats</span><span class="p">[</span><span class="n">min_str</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_val</span>
    <span class="n">improve_stats</span><span class="p">[</span><span class="n">mean_str</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_val</span>
    <span class="k">return</span> <span class="n">improve_stats</span></div>


<div class="viewcode-block" id="get_deterioration_stats"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.get_deterioration_stats">[docs]</a><span class="k">def</span> <span class="nf">get_deterioration_stats</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">method1</span><span class="p">,</span> <span class="n">method2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gets the deterioration statistics of `method1` over `method2`.</span>

<span class="sd">    The deterioration statistics of `method1` over `method2` are based on</span>
<span class="sd">    `results_df` and represent statistics for the instances where `method1`</span>
<span class="sd">    is worse than `method2`. These statistics are the percent of instances</span>
<span class="sd">    in which `method1` is worse than `method2` as well as the maximum and</span>
<span class="sd">    mean ratio of the two methods in these instances.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    results_df: pd.DataFrame</span>
<span class="sd">        A pandas DataFrame of experimental results for the methods.</span>
<span class="sd">    method1: str</span>
<span class="sd">        A string representing the method of interest.</span>
<span class="sd">    method2: str</span>
<span class="sd">        A string representing the method being compared against.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        A dictionary recording the deterioration statistics of `method1` over</span>
<span class="sd">        `method2`. The keys are strings representing the names of the various</span>
<span class="sd">        statistics and the corresponding value is the value of the statistic.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deter_stats</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">percent_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f instances with </span><span class="si">{0}</span><span class="s2"> &gt; </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method1</span><span class="p">,</span> <span class="n">method2</span><span class="p">)</span>
    <span class="n">max_str</span> <span class="o">=</span> <span class="s2">&quot;max </span><span class="si">{0}</span><span class="s2"> / </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method1</span><span class="p">,</span> <span class="n">method2</span><span class="p">)</span>
    <span class="n">mean_str</span> <span class="o">=</span> <span class="s2">&quot;deterioration mean </span><span class="si">{0}</span><span class="s2"> / </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method1</span><span class="p">,</span> <span class="n">method2</span><span class="p">)</span>
    <span class="n">deter_stats</span><span class="p">[</span><span class="n">percent_str</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_proportion_better</span><span class="p">(</span>
        <span class="n">results_df</span><span class="p">,</span> <span class="n">method2</span><span class="p">,</span> <span class="n">method1</span><span class="p">)</span>
    <span class="n">max_val</span><span class="p">,</span> <span class="n">mean_val</span> <span class="o">=</span> <span class="n">get_deterioration_ratios</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">method1</span><span class="p">,</span> <span class="n">method2</span><span class="p">)</span>
    <span class="n">deter_stats</span><span class="p">[</span><span class="n">max_str</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_val</span>
    <span class="n">deter_stats</span><span class="p">[</span><span class="n">mean_str</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_val</span>
    <span class="k">return</span> <span class="n">deter_stats</span></div>


<div class="viewcode-block" id="compare_heuristic_results"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.compare_heuristic_results">[docs]</a><span class="k">def</span> <span class="nf">compare_heuristic_results</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">method1</span><span class="p">,</span> <span class="n">method2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compares `method1` and `method2` based on `results_df`.</span>

<span class="sd">    A dictionary is created recording statistics of the comparison between</span>
<span class="sd">    `method1` and `method2` in `results_df`. The statistics calculated</span>
<span class="sd">    are the percent of instances where `method1` is less than `method2`, as</span>
<span class="sd">    well as the minimum and average ratio of `method1` to `method2` for those</span>
<span class="sd">    instances. Likewise, the percent of instances where `method1` is greater</span>
<span class="sd">    than `method2`, as well as the maximum and average ratio of `method1` to</span>
<span class="sd">    `method2` for those instances.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    results_df: pd.DataFrame</span>
<span class="sd">        A pandas DataFrame containing experimental results for the</span>
<span class="sd">        heuristics.</span>
<span class="sd">    heuristic1: str</span>
<span class="sd">        A string representing the name of one of the heuristics being</span>
<span class="sd">        compared.</span>
<span class="sd">    heuristic2: str</span>
<span class="sd">        A string representing the name of the other heuristic being</span>
<span class="sd">        compared.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        A dictionary containing the comparison statistics between the</span>
<span class="sd">        two heuristics.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span><span class="o">**</span><span class="n">get_improvement_stats</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">method1</span><span class="p">,</span> <span class="n">method2</span><span class="p">),</span>
            <span class="o">**</span><span class="n">get_deterioration_stats</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">method1</span><span class="p">,</span> <span class="n">method2</span><span class="p">)}</span></div>


<div class="viewcode-block" id="get_heuristic_discrepancy_df"><a class="viewcode-back" href="../../Model/analysis.html#MigrationScheduling.analysis.get_heuristic_discrepancy_df">[docs]</a><span class="k">def</span> <span class="nf">get_heuristic_discrepancy_df</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">opt_col</span><span class="p">,</span> <span class="n">heuristic_cols</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A df of the discrepancies between `heuristic_cols` and `opt_col`.</span>

<span class="sd">    Calculates the percentage of instances for each heuristic in</span>
<span class="sd">    `heuristic_cols` that deviate from the optimal value in `opt_col` based</span>
<span class="sd">    on the results in `results_df`. The percentages are grouped by value of</span>
<span class="sd">    the optimal solution. That is, for an optimal value `x` the percentages</span>
<span class="sd">    are calculated across all instances that have an optimal value of `x`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    results_df: pd.DataFrame</span>
<span class="sd">        A pandas DataFrame containing the results from which the</span>
<span class="sd">        discrepancies are calculated.</span>
<span class="sd">    opt_col: str</span>
<span class="sd">        A string representing the name of the column in `results_df` holding</span>
<span class="sd">        the values of the optimal solutions.</span>
<span class="sd">    heuristic_cols: list</span>
<span class="sd">        A list of strings representing the names of the heuristics for which</span>
<span class="sd">        the discrepancies are calculated.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">        A pandas DataFrame containing the percentage of instances where the</span>
<span class="sd">        heuristic solution value is different than the optimal value. Results</span>
<span class="sd">        are grouped by optimal value and reported for each heuristic.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">disc_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_disc&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">col_name</span><span class="p">)</span> <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="n">heuristic_cols</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">heuristic_cols</span><span class="p">)):</span>
        <span class="n">results_df</span><span class="p">[</span><span class="n">disc_cols</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="n">results_df</span><span class="p">[</span><span class="n">heuristic_cols</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="n">results_df</span><span class="p">[</span><span class="n">opt_col</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">disc_df</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[[</span><span class="n">opt_col</span><span class="p">]</span> <span class="o">+</span> <span class="n">disc_cols</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">opt_col</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">disc_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">heuristic_cols</span>
    <span class="k">return</span> <span class="n">disc_df</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Matt Buckley.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>